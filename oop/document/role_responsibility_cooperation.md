# 역할 / 책임 / 협력

## 협력

협력은 한 객체가 다른 객체에 요청할 때 시작되며, 결과적으로 협력은 다수의 요청과 응답으로 구성된다.  
그 요청과 응답은 협력에 참여하는 객체가 수행할 책임을 정의하게 된다.

## 책임

책임은 객체 지향 설계 품질을 결정하는 가장 중요한 요소이며, 크게 두 가지 분류로 나눌 수 있다.

- Knowing(정보): 자신의 정보 / 관련된 객체의 정보 / 유도하거나 계산할 수 있는 정보
- Doing(서비스): 객체를 생성하거나 계산을 수행하는 등의 스스로 하는 것 / 다른 객체의 행동을 시작 혹은 제어하는 것

위 객체의 정보와 서비스를 이용해 공용 인터페이스(public interface)를 구성할 수 있다.  
이 공용 인터페이스는 객체지향의 중요한 특성인 캡슐화로 이어진다.

### 책임과 메시지

객체는 다른 객체에게 주어진 책임을 수행하도록 요청을 보내는 메시지 전송(`message-send`)이 이루어졌을 때만 책임을 수행한다.

## 역할

여러 가지의 협력은 포괄하여 하나의 역할로 표현할 수 있게 된다.  
동일한 역할을 수행한다는 것은 동일한 책임의 집합을 수행한다는 것을 의미한다.  
이를 확장하면 객체지향 설계의 단순성(`simplicity`), 유연성(`flexibility`), 재사용성(`reusability`)을 뒷받침하는 핵심 개념이 된다.

### 협력의 추상

역할을 부여함으로써 가장 큰 효과는 하나의 협력 안에 여러 종류의 객체가 참여할 수 있게 하여 협력을 추상화할 수 있다는 것이다.  
협력의 추상화는 다뤄야하는 협력의 개체를 줄이면서 구체적 객체를 추상화된 역할로 대체함으로써 애플리케이션의 설계를 이해하기 쉬워진다.

### 대체 가능성

역할은 협력 안에서 구체적인 객체로 대체될 수 있는 추상적인 협력자이므로, 다른 객체에 의해 대체 가능함을 의미한다.  
그렇다고 아무 객체가 역할을 대체하는 것이 아닌 해당 역할(책임의 집합)을 모두 수행할 수 있어야 한다.(해당 역할보다 더 많은 책임을 가질 수 있다.)
> 역할의 대체 가능성 = 행위의 호환성 = 동일한 책임의 수행

## 객체의 모양을 결정하는 협력

객체가 시스템에 필요한 데이터를 저장하기 위해 존재한다고 오해하기 쉽지만, 객체는 데이터를 포함하고 행위를 수행하는 데 필요할 뿐, 행위를 수행하며 협력에 참여하기 위해 존재한다.  
각 객체를 독립적으로 바라보면 안 되고, `협력이라는 문맥을 고려하여 설계`해야 클래스 중심이 아닌 객체지향적인 설계할 수 있다.

### 협력을 따라 흐르는 객체의 책임

깔끔한 협력 설계로부터 올바른 객체 설계가 시작된다. 올바른 협력 설계를 하기 위해서는 아래의 플로우를 따라가는 것이 좋다.

1. 협력에 참여하는 객체들이 어떤 책임을 수행할지 할당
2. 할당 된 책임을 통해 개체가 외부에 제공하게 될 행동을 결정
3. 객체가 수행하게 될 적절한 책임을 수행하는 데 필요한 데이터를 결정
4. 데이터와 행동이 결정 된 후에 클래스 구현 방법 결정

## 객체지향 설계 기법

역할 / 책임 / 협력 관점에서 애플리케이션을 설계하는 유용한 세 가지 기법이 있다.

### 책임-주도 설계(`Responsibility-Driven Design`)

책임-주도 설계에서는 시스템의 책임을 객체의 책임으로 변환하여, 각 객체가 책임 수행 중 필요한 협력자를 찾아 책임을 할당하는 순차적인 방식으로 협력 공동체를 설계한다.  
개별 객체 상태가 아닌 객체의 책임과 상호작용에 초점을 맞추어 설계하므로, 협조적인 객체를 만들 수 있다.  
책임-주도 설계를 하기 위한 절차는 아래와 같다.

- 시스템이 사용자에게 제공해야 하는 기능(시스템 책임) 파악
- 시스템 책임을 더 작은 책임으로 분할
- 분할된 책임을 수행할 수 있는 적절한 객체(역할)을 찾아 책임을 할당
- 객체가 책임을 수행하는 중에 다른 객체의 도움이 필요한 경우 이를 책임질 객체(역할) 탐색
- 해당 객체(역할)에 책임을 할당함으로써 두 객체 협력 관계 시작

### 디자인 패턴

책임-주도 설계는 객체의 역햘/책임/협력을 고한하기 위한 방법 및 `절차`를 제시한 반면, 디자인 패턴은 책임-주도 설계의 `결과`를 표현한다.  
이미 잘 알려지고 검증된 설계를 재사용할 수 있도록 패턴화한 것으로, 빠르고 손쉽게 결과물을 만들 수 있도록 도와준다.

### 테스트-주도 개발

단순히 테스트를 작성하는 것이 아니라 책임을 수행할 객체 또는 클라이언트가 기대하는 책임과 협력을 테스트 코드 형태로 작성하는 것이다.  
책임-주도 설계의 기본 개념을 따르기 때문에 객체지향에 대해 깊이 있는 지식을 요구하게 된다.

###### 참고자료

- [객체지향의 사실과 오해: 역할, 책임, 협력 관점에서 본 객체지향](https://www.nl.go.kr/seoji/contents/S80100000000.do?schM=intgr_detail_view_isbn&page=1&pageUnit=10&schType=simple&schStr=객체지향의+사실&isbn=9788998139766&cipId=200539082%2C4626710)