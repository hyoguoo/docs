!! 문서 정리 필요

# 프록시

일반적으로 클라이언트가 서버를 직접 호출하고, 처리 결과를 직접 받는다.  
여기서 중간에 대리자를 두고, 대리자가 서버를 호출하고, 결과를 받아서 클라이언트에게 전달하는 방법이 있는데,  
여기서 대리자를 프록시라고 하며, 프록시는 또 다른 프록시를 호출할 수 있다.(프록시 체인)

## 대체 가능

어떤 객체든 프록시가 될 수 있는 것이 아니라 서버의 인터페이스를 구현한 객체만 프록시가 될 수 있다.(=같은 인터페이스를 구현한 객체로 대체 가능)

## 프록시 주요 기능

- 접근 제어
    - 권한에 따른 접근 차단
    - 캐싱
    - 지연 로딩
- 부가 기능 추가
    - 원래의 서버가 제공하지 않는 기능 추가

## GOF 디자인 패턴

기본적으로 둘 다 프록시를 사용하는 방법이다.
GOF 디자인 패턴에서 둘의 의도(indent)에 따라서 프록시 패턴과 데코레이터 패턴으로 구분한다.

- 프록시 패턴: 접근 제어
- 데코레이터 패턴: 부가 기능 추가

프록시 패턴과 프록시를 별개로 봐야하며 프록시 패턴은 이름 그대로 디자인 패턴의 이름이다.

## Proxy Factory 

프록시를 생성하는 방법으론 JDK 동적 프록시 / CGLIB 라이브러리를 사용하는 방법이 있다.  
하지만 구현하려는 프록시의 원본 객체에 인터페이스 여부에 따라서 사용하는 방법이 달라지며, 생성하는 방법도 달라진다.  
스프링에서는 Proxy Factory와 Advice를 사용하여 프록시 생성 방법을 추상화하고 통일했다.

- Proxy Factory: 프록시를 생성하는 기능을 제공
- Advice: 부가 기능을 제공하는 기능을 제공

스프링 부트에서는 항상 CGlib를 이용해 프록시를 생성한다. 

### 포인트컷 / 어드바이스 / 어드바이저

- 포인트컷(Pointcut): 어떤 메서드를 어드바이스(부가 기능)를 적용할 지 선정하는 기능, 클래스와 메서드 이름으로 필터링 -> 필터 역할
- 어드바이스(Advice): 부가 기능을 제공하는 기능, 메서드 형태로 구현 -> 기능 로직 담당
- 어드바이저(Advisor): 포인트컷 + 어드바이스

## ETC

- 스프링 빈으로 실제 객체 대신에 프록시 객체를 등록했기 때문에 앞으로 스프링 빈을 주입 받으면 실제 객체 대신에 프록시 객체가 주입
- 프록시 객체는 스프링 컨테이너가 관리하고 자바 힙 메모리에도 올라간다. 반면에 실제 객체는 자바 힙 메모리에는 올라가지만 스프링 컨테이너가 관리하지는 않는다.

###### 참고자료

- [스프링 핵심 원리 - 고급편](https://www.inflearn.com/course/스프링-핵심-원리-고급편)