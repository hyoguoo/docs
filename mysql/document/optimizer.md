# 옵티마이저

> 최적의 실행 계획을 수립

## 쿼리 실행 절차

1. SQL Parsing: 사용자로부터 요청된 SQL 문장을 잘게 쪼개서 MySQL 서버가 이해할 수 있는 수준으로 분리(Parse Tree)
2. 최적화 및 실행 계획 수립: SQL 파싱 정보(Parse Tree)를 확인하면서 어떤 테이블로부터 읽고 어떤 인덱스를 이용해 테이블을 읽을지 결정(Execution Plan)
    - 불필요한 조건 제거 및 복잡한 연산 단순화
    - 여러 테이블의 조인이 있는 경우 어떤 순서로 테이블을 읽을지 결정
    - 각 테이블에 사용된 조건과 인덱스 통계 정보를 이용해 사용할 인덱스 결정
    - 가져온 레코드들을 임시 테이블에 넣고 재가공이 필요한지 결정
3. 데이터 읽음: 위에서 결정된 테이블의 읽기 순서나 선택된 인덱스를 이용해 스토리지 엔진으로부터 데이터를 읽어옴

1, 2 단계는 거의 MySQL 엔진에서 처리하며, 세 번째 단계는 MySQL 엔진과 스토리지 엔진이 동시에 처리

## 옵티마이저의 종류

- 비용 기반 최적화(Cost-based Optimizer): 대부분의 DBMS가 사용하는 옵티마이저
    - 쿼리 처리를 위한 여러 가지 가능한 방법을 만들고, 각 단위 작업의 비용 정보와 통계 정보를 이용해 실행 계획별 비용 산출
    - 비용이 가장 적은 실행 계획을 선택
- 규칙 기반 최적화(Rule-based Optimizer): 예전 초기 버전의 오라클 DBMS에서 사용
    - 대상 테이블의 레코드 건수나 선택도 등을 고려하지 않고 옵티마이저에 내장된 우선순위에 따라 실행 계획을 수립하는 방식
    - 통계 정보(테이블 레코드 건수나 컬럼값의 분포도)를 고려하지 않고 실행 계획이 수립되어 항상 같은 실행 방법 생성

###### 참고자료

- [Real MySQL 8.0 1](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=284710853)